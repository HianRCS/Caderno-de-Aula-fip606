{
  "hash": "0f19ddf8fb70f6b9636b923c93f67573",
  "result": {
    "markdown": "---\ntitle: \"Corgraph e Gráficos\"\nformat: html\neditor: visual\nwarning: false\nmensage: false\n---\n\n\n## Dados de Imagens corgraph\n\nO pacote corgraph no RStudio oferece ferramentas para visualizar e analisar redes complexas. Essas redes podem representar diversas relações entre entidades, como interações entre proteínas, relações sociais em uma comunidade ou conexões entre diferentes sites na internet. O corgraph permite criar diversos tipos de gráficos de rede, como grafos lineares, grafos circulares e grafos em 3D, além de fornecer funções para calcular métricas de rede e realizar análises de rede.\n\n\n::: {.cell hash='aula10_cache/html/unnamed-chunk-1_ecacdb0239adc7257c17e3198ee2ec80'}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(gsheet)\nlibrary(ggplot2)\nlibrary(ggthemes)\nlibrary(AgroR)\nlibrary(corrplot)\nlibrary(drc)\nlibrary(ec50estimator)\nlibrary(dplyr)\nlibrary(dbplyr)\n\n\n\nimgs <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=373270992\")\n\nimgs |>\n  pivot_longer(3:5, names_to = \"method\",\n               values_to = \"value\") |>\n  ggplot(aes(method, value))+\n  geom_boxplot()+\n  geom_point(color = \"red\")\n```\n\n::: {.cell-output-display}\n![](aula10_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n\n```{.r .cell-code}\nimgs |>\n  ggplot(aes(Assess, ImageJ))+\n  geom_point()+\n  geom_smooth()\n```\n\n::: {.cell-output-display}\n![](aula10_files/figure-html/unnamed-chunk-1-2.png){width=672}\n:::\n\n```{.r .cell-code}\nimgs |>\n  ggplot(aes(Assess, LeafDoctor))+\n  geom_point()+\n  geom_smooth()\n```\n\n::: {.cell-output-display}\n![](aula10_files/figure-html/unnamed-chunk-1-3.png){width=672}\n:::\n\n```{.r .cell-code}\nimgs2 <- imgs |>\n  dplyr::select(3:5)\n\n\ncorgraph(imgs2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n        Var1       Var2       cor            p\n2 LeafDoctor     Assess 0.9666367 5.972544e-42\n3     ImageJ     Assess 0.9776918 8.143613e-48\n6     ImageJ LeafDoctor 0.9797478 3.144091e-49\n```\n:::\n\n::: {.cell-output-display}\n![](aula10_files/figure-html/unnamed-chunk-1-4.png){width=672}\n:::\n\n```{.r .cell-code}\ncor.test(imgs$Assess, imgs$LeafDoctor)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tPearson's product-moment correlation\n\ndata:  imgs$Assess and imgs$LeafDoctor\nt = 31.119, df = 68, p-value < 2.2e-16\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n 0.9466882 0.9792005\nsample estimates:\n      cor \n0.9666367 \n```\n:::\n\n```{.r .cell-code}\ncor(imgs$Assess, imgs$LeafDoctor)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.9666367\n```\n:::\n\n```{.r .cell-code}\ncor_imgs2 <- cor(imgs2)\ncorrplot(cor_imgs2, method = \"number\", type = \"lower\", diag = FALSE)\n```\n\n::: {.cell-output-display}\n![](aula10_files/figure-html/unnamed-chunk-1-5.png){width=672}\n:::\n:::\n\n\n## dados campo\n\n\n::: {.cell hash='aula10_cache/html/unnamed-chunk-2_64ed2ab120cf9323da85472aee52c3f4'}\n\n```{.r .cell-code}\ncampo <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=866852711\")\n\ncampo2 <- campo |>\n  dplyr::select(DFC, FER, PROD)\ncorgraph(campo2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  Var1 Var2        cor            p\n2  FER  DFC  0.9316978 9.864101e-15\n3 PROD  DFC -0.6928161 1.110652e-05\n6 PROD  FER -0.6258321 1.277444e-04\n```\n:::\n\n::: {.cell-output-display}\n![](aula10_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n\n```{.r .cell-code}\ncampo |>\n  ggplot(aes(DFC, PROD))+\n  geom_point()\n```\n\n::: {.cell-output-display}\n![](aula10_files/figure-html/unnamed-chunk-2-2.png){width=672}\n:::\n:::\n\n\n## dados do estande\n\n\n::: {.cell hash='aula10_cache/html/unnamed-chunk-3_4b68d163227f6156bb8b6f5b3e1a9a4c'}\n\n```{.r .cell-code}\nestande <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=401662555\")\n\nestande |>\n  ggplot(aes(trat, nplants))+\n  geom_jitter(width = 0.1, alpha = 0.5, color = \"red\") +\n  facet_wrap(~ exp) +\n  stat_summary(fun.data = \"mean_cl_boot\", color = \"black\") +\n  geom_smooth(method = lm, se = F, color = \"orange\")\n```\n\n::: {.cell-output-display}\n![](aula10_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n\n```{.r .cell-code}\nexp2 <- estande |>\n  filter(exp == 2)\n\n\nexp2 |>\n  ggplot(aes(trat, nplants))+\n  geom_point()+\n  ylim(0,100)+\n  geom_smooth(method = \"lm\",\n              se = F,\n              formula = y ~poly(x,2),\n              color = \"black\")+\n  geom_smooth(method = \"lm\",\n                se = FALSE)\n```\n\n::: {.cell-output-display}\n![](aula10_files/figure-html/unnamed-chunk-3-2.png){width=672}\n:::\n\n```{.r .cell-code}\nlm2 <- lm(nplants ~ trat,\n          data = exp2)\nsummary(lm2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = nplants ~ trat, data = exp2)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-25.7816  -7.7150   0.5653   8.1929  19.2184 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  60.9857     3.6304  16.798 4.93e-14 ***\ntrat         -0.7007     0.1605  -4.365 0.000247 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 12.95 on 22 degrees of freedom\nMultiple R-squared:  0.4641,\tAdjusted R-squared:  0.4398 \nF-statistic: 19.05 on 1 and 22 DF,  p-value: 0.0002473\n```\n:::\n\n```{.r .cell-code}\nexp2$nplants2 <- exp2$nplants\nlm2 <- lm(nplants ~trat,\n          data = exp2)\n\n\nexp2$trat2 <- exp2$trat^2\nlm2 <- lm(nplants ~ trat,\n          data = exp2)\n\nlm3  <- lm(nplants ~ trat + trat2, \n           data = exp2)\n\nsummary(lm2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = nplants ~ trat, data = exp2)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-25.7816  -7.7150   0.5653   8.1929  19.2184 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  60.9857     3.6304  16.798 4.93e-14 ***\ntrat         -0.7007     0.1605  -4.365 0.000247 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 12.95 on 22 degrees of freedom\nMultiple R-squared:  0.4641,\tAdjusted R-squared:  0.4398 \nF-statistic: 19.05 on 1 and 22 DF,  p-value: 0.0002473\n```\n:::\n\n```{.r .cell-code}\nsummary(lm3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = nplants ~ trat + trat2, data = exp2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-25.439  -6.019   1.789   8.016  19.561 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 66.30156    4.42097  14.997 1.08e-12 ***\ntrat        -1.77720    0.58467  -3.040  0.00623 ** \ntrat2        0.02223    0.01166   1.906  0.07036 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 12.24 on 21 degrees of freedom\nMultiple R-squared:  0.5432,\tAdjusted R-squared:  0.4997 \nF-statistic: 12.49 on 2 and 21 DF,  p-value: 0.0002675\n```\n:::\n\n```{.r .cell-code}\nAIC(lm2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 194.9597\n```\n:::\n\n```{.r .cell-code}\nAIC(lm3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 193.1284\n```\n:::\n\n```{.r .cell-code}\nhist(residuals(lm2))\n```\n\n::: {.cell-output-display}\n![](aula10_files/figure-html/unnamed-chunk-3-3.png){width=672}\n:::\n\n```{.r .cell-code}\nwith(exp2, polynomial(trat, nplants, grau = 2))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n----------------------------------------------------\nRegression Models\n----------------------------------------------------\n               Estimate Std. Error   t value     Pr(>|t|)\n(Intercept) 66.30156250 4.42096799 14.997069 1.079972e-12\ntrat        -1.77719814 0.58467380 -3.039640 6.230050e-03\nI(trat^2)    0.02222876 0.01165948  1.906496 7.036247e-02\n\n----------------------------------------------------\nDeviations from regression\n----------------------------------------------------\n          Df       SSq       MSQ         F      p-value\nLinear     1 3196.2031 3196.2031 21.823293 0.0001899378\nQuadratic  1  544.5029  544.5029  3.717801 0.0697619482\nDeviation  3  509.6690  169.8897  1.159986 0.3523240106\nResidual  18 2636.2500  146.4583                       \n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n[[1]]\n```\n:::\n\n::: {.cell-output-display}\n![](aula10_files/figure-html/unnamed-chunk-3-4.png){width=672}\n:::\n:::\n\n\n## dados de sensibilidade de fungicida\n\n\n::: {.cell hash='aula10_cache/html/unnamed-chunk-4_b502037c8d18b11dc1fda2fd58cde726'}\n\n```{.r .cell-code}\npyra <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=465348652\")\n\npyra |>\n  group_by(code, dose) |>\n  summarise(mean_germination = mean(germination)) |>\n  ggplot(aes(dose, mean_germination))+\n  geom_jitter()+\n  facet_wrap(~code)\n```\n\n::: {.cell-output-display}\n![](aula10_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n\n```{.r .cell-code}\npyra2 <- pyra |>\n  group_by(code, dose) |>\n  summarise(mean_germination = mean(germination))\n\n\nisolado165 <- pyra2 |>\n  filter(code == \"165\")\n\ndrc1 <- drm(mean_germination ~dose, data = isolado165,\n            fct = LL.3())\n\ndf_ec50 <- estimate_EC50(mean_germination ~ dose, \n                         data = pyra2,\n                         isolate_col = \"code\",\n                         interval = \"delta\",\n                         fct = drc:: LL.3())\ndf_ec50 |>\n  ggplot(aes(reorder(ID, Estimate), Estimate))+\n  geom_point()+\n  geom_errorbar(aes(ymin = Lower, ymax = Upper), width = 0.1)+\n  coord_flip()\n```\n\n::: {.cell-output-display}\n![](aula10_files/figure-html/unnamed-chunk-4-2.png){width=672}\n:::\n\n```{.r .cell-code}\nAIC(drc1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 31.55522\n```\n:::\n\n```{.r .cell-code}\nplot(drc1)\n```\n\n::: {.cell-output-display}\n![](aula10_files/figure-html/unnamed-chunk-4-3.png){width=672}\n:::\n\n```{.r .cell-code}\nED(drc1, 50, interval = \"delta\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nEstimated effective doses\n\n       Estimate Std. Error   Lower   Upper\ne:1:50  0.55840    0.11420 0.19498 0.92182\n```\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}